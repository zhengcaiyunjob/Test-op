# mock相关问题调研

​	随着前端技术日新月异的发展，对开发的效率有了更多的要求，例如：各种框架，模板，组件的出现大大提高了开发的效率，各种mock系统的出现也让前后端分离变得更得心应手。目前业界也出现了各种各样的mock系统，其中比较成熟的有：RAP，Easy mock等，以及目前内部使用的vane，portm，猴王，Appmock等，为了让重新规划的系统在后期能更方便的供开发同学使用，本文在此基础上对已经存在的系统做了深度调研，分析了各种已有系统存在的优缺点，希望能再此基础上找到更好的解决方案。

## 1，vane

​	vane是目前内部使用的所有mock系统中功能相对比较完备的系统，囊括了接口定义，请求参数，请求体，响应头，响应体，接口测试，服务代理等功能。大体上能够满足目前开发同学的需求。

#### vane系统的优势：

1. 根据title的描述来区分不同的接口，辨识度较高，用户使用的成本较低；
2. 在接口设定的基础上，用户可以根据特定的请求参数设置不同的请求参数，包括cookie，可扩展性较强；
3. 可以进行响应头和响应体的设置；
4. 在对响应体的设置过程中，利用jsonSchema来对json数据进行描述，可以针对用户输入的json值自动生成响应的数据格式，同时也能根据用户设定的数据格式随机生成假数据，自动化程度较高。
5. 接口设定完毕，可以进行测试，报告每次生成的数据格式和理想数据格式的区别，易于用户对于兼容性的改进。
6. 根据接口的设定，生成接口的报告，方便用户查阅，但是并不利于分享。
7. 服务代理，可以根据用户的设置，过滤mock平台提供的接口，未设定接口直接转发到dev环境，而无需用户做各种设定，非常方便。
8. 访问接口的速度限制设置；
9. 生成的数据放在本地的adocs里，可以很方便用户的修改；

#### vane系统的劣势

1. 缺少项目的分组，都是前端同学自己在本地的环境上填写关于接口的定义，在本地使用，不利于接口的管理。而且另一方面，缺少后端同学的参与，目前的状态是大概如下操作：

+ 后端同学在wiki上定义接口，
+ 前端同学根据接口的定义在vane系统上填写接口的各种设置；
+ 前端同学根绝后端同学提供的json值设定接口的响应体；
+ 根据响应体生成的schema类型生成数据，并修改schema类型；
+ 必要时候设定请求参数并修改请求体；

​        总体看来，前端同学的这个过程的操作是对后端同学接口定义的重复，为了减少这种重复劳动，理想的状态是后端同学对接口的定义能在该平台上完成，按照项目进行接口的分组，在分组类定义的接口信息将直接被保存，前端同学进入项目后能直接看到该接口生成的新数据，避免二次开发；

2. 请求参数的设定过程，交互的友好型有待商定。例如点击首页->类型列表->添加参数，首先用户不是很清楚这是关于什么的参数，没有使用帮助和提示；
3. 请求参数的设置过程累赘，基本上是复制了响应体设置的功能，而且参数设置的添加部分的功能是重复的，在现行系统下，参数设置的功能如下图1所示(暂时无法粘贴)，非常不利于用户的有好编辑和查看：理想的状态有待商定。
4. 生成的schema类型的响应体中的字段有缺少行为，不利于调试。具体表现在图2所示：
5. 测试阶段所做的工作就是对比了随机生成的数据和真是情况想要的数据之间的差异，而且每一个参数分开来测试的过程并不合理。
6. 生成的json文件放在本地，是利于用户的修改，但是这样不利于用户对这些文件的保留和集中的管理，每次一个新项目都得重新配置，可以同时保留在远端，方便用户的更新。
7. 代理部分，目前vane的代理设计的还比较合理，可以借鉴和学习。


##2，Rap分析

​	Rap系统目前是阿里旗下的一个用于前端数据调试的mock系统，所有的接口按照团队和项目进行划分，有效隔离接口和接口之间的影响，同时定义和测试分离，方便用户的查阅。

所有的数据类型囊括![](https://ws2.sinaimg.cn/large/006tNc79ly1fjuo9awrnmj307w0aswf1.jpg)

​




