#一，项目背景

​	目前公司的大部分项目开始实现前后端分离的开发方式，这种开发方式所带来的直接问题是前端同学在开发初期无法依赖后端的数据，无法提前做各种调试和测试工作，严重影响了开发的进度。因此，需要一个模拟后端数据的系统来（后面简称mock系统）帮助广大前端同学解决这一难题，目前公司内部出现了各种类似的模拟系统，但是都没有很好的解决前端和后端同学关于接口定义和开发的这一难题（各种mock系统的调研报告详见wiki：）。

​	整理了各中mock系统问题，同事和广大的RD同学做了深入的交流后，遂整理了相关的开发痛点和相关的意见，希望能将这些建议和想法做一些整合，生成一个新的系统供大家使用，使前后端的同学都能参与进来，而且保证每一项工作只需要一个角色去完成，绝不出现重复的操作。

整合包括以下几个方面：

1. 后端同学直接在该平台上创建接口，提交的接口信息以http协议传送给后端，后端将数据存储；
2. 后端通过提交的接口数据生成模拟数据；
3. 后端定义的接口数据一经提交，前端同学立即可以在本项目目录内点击查看已经生成的接口及数据，无需在做其他操作；
4. 接口数据的校验，主要是请求数据的校验；
5. 定义接口之间的关联规则；
6. 接口数据的限定规则；



#二，项目规划
​	该项目初步确定以用户体验为中心，多期迭代开发，通过多次迭代达到用户满意的状态。目标旨在多次迭代开发的基础上形成一个良性运行的mock系统。针对已有的讨论情况，目前的主要规划如下：

1. 一期：项目创建、接口创建、生成初步的mock数据；
2. 二期：

  ​（1）mock数据精细化开发，生成一套模拟的规则，同时扩大数据的类型选择（例如图片，文件，颜色等）；

  ​（2）接口的转发规则；

3. 三期：对用户易用性功能改进、接口关联规则设定；

   ​

#三，详细设计

#### 1.一期设计

​	一期设计主要包括主要的功能（参照二中的1期规划），主要是能让RD同学和FE同学都参与进来，而且避免重复性劳动。RD同学负责在系统中做接口定义后，不需要前端同学在做其他操作即可直接获取生成的mock数据。

一期开发设计的功能，通过具体的开发达成的具体目标如下所示：

(1) 项目记录

​	项目记录的目的是将所有的接口按项目分类，每一个项目包括项目ID（id），项目名称(name)，项目描述(description)，如表1所示。

| 名称          | 类型     | 描述   |
| ----------- | ------ | ---- |
| id          | String | 项目id |
| name        | string | 项目名称 |
| Description | String | 项目描述 |

​											表1    项目属性

​	项目的功能主要包括项目的增加、修改、删除、查询等功能，初步规划，项目为系统的基本单元，所有的接口划分以项目为基础。其具体视觉如图1所示：

![](https://ws2.sinaimg.cn/large/006tNc79ly1flz1f6ycppj31kw0obq4x.jpg)

​										图1： 项目方案设计

​	将所有的接口按照项目进行划分，避免了接口过多带来的各种不便。

(2)接口设计

​       接口是数据呈现的载体，其属性主要包括接口id，项目ID，接口名称，接口URL，接口的请求参数，接口的响应参数，接口描述，接口模拟数据，接口的请求方式。其中接口id在数据库中是以递增的方式产生；项目ID表示该接口所属的项目；接口名称拟指命名，方便用户查看；接口url即为请求的url；requestSet表示请求的参数；responseSet表示用户期待的返回模拟数据的类型；method表示请求方法。各种属性的介绍如表2所示。


| 名称          | 类型     | 描述     |
| ----------- | ------ | ------ |
| interfaceId | number | 接口id   |
| projectId   | number | 对应项目id |
| title       | string | 接口名称   |
| url         | string | 接口url  |
| requestSet  | string | 请求参数   |
| responseSet | string | 返回参数   |
| description | string | 接口描述   |
| response    | string | 模拟数据   |
| method      | string | 请求方法   |

​											表2  接口属性

​	每一个接口对应一个项目id，一个项目id对应多个接口，同一个项目中不允许出现相同的接口URL，例如在项目id(15392874637)对应的项目中存在/getList/query此接口，再次添加时，以/getList/query为url的接口添加不予通过，即便是传入参数不同。接口的设计方案视图如图2所示：

![](https://ws3.sinaimg.cn/large/006tNc79ly1flz1idu15cj31kw16h0yv.jpg)	

​										图2： 接口设计方案

（3）模拟规则

​	数据的模拟是根据用户输入的期望数据来生成相应的模拟数据，这一功能是整个系统的核心功能，数据的模拟需要设定特定的规则，主要包括数据的限定规则设计、数据之间的关联规则设计。数据的限定规则设计包括数据的长度，值的范围等规则；数据之间的关联规则设计是指当发起一个请求时，用户希望数据发生变化的规则。例如，在结算项目中有时候会碰见账单审核的变化，假使当前的账单状态分为4种（1：未审核，2：已通过，3：未通过，4：驳回），当前账单为新录入状态，提交之后希望系统能够在2，3，4三种状态中选择其中一种，而不再出现1，这种规则为接口数据的关联规则，很多结算的项目目前只能通过线上环境去试验，所以希望通过数据关联规则的增加来解决这一问题。在一期设计中还未考虑限定规则设计和数据关联规则设计（未完，还在思考，二期补充）。一期主要是根据相应的数据类型做了相应的数据生成，二期的时候会加入各种规则。

​	数据的限定规则主要包括(暂未考虑全面，欢迎补充)：

> 数据的长度；
>
> 数据自增；
>
> 数据重复；
>
> 数据的最大，最小值；
>
> 枚举范围；
>
> …...

​	数据的关联规则（暂未想好，怎么设计）：

规则的设计的最大的弊端是过于精细和复杂，造成学习成本较大，后续我会整理出一些规则并进行分类。



